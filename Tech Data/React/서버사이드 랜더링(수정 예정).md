# 서버사이드 랜더링

필수 작업이 아니기 떄문에, 서버사이드 랜더링을 구현하지 않을 수도 있습니다. 서버사이드 랜더링을 구현하기 전에, 실제로 프로젝트에 필요한지 고려해볼 필요가 있습니다.

## 1. 서버사이드 랜더링 장점

### 1.1 검색 엔진 최적화

리액트, 혹은 다른 자바스크립트 라이브러리/프레임워크로 만들어져 뷰 렌더링이 자바스크립트 위주로 돌아가는 프로젝트는 자바스크립트 엔진이 돌아가지 않으면 원하는 정보를 표시해주지 않습니다. 따라서, 클라이언트 렌더링만 될 경우엔 검색엔진 크롤러가 어플리케이션이 지닌 데이터들을 제대로 수집하지 못합니다. 검색 엔진중 가장 중요한 구글 검색 엔진은 크롤러에 자바스크립트 엔진이 내자오디어 있어서 우리가 별도로 작업을 하지 않아도 제대로 렌더링해줍니다. 하지만 네이버, 다음 등의 검색엔진이 사이트를 크롤링 하게 지원해야 한다면, 서버사이드 렌더링을 따로 구현해야 합니다.

### 1.2 성능 개선

서버사이드 렌더링을 하게되면, 첫 렌더링된 html을 클라이언트에게 전달 해주기때문에 초기 로딩속도를 많이 줄여줄 수 있습니다. 자바스크리브 파일을 불러오고 렌더링 작업이 완료되기 전에도 유저가 사이트의 컨텐츠를 이용 할 수 있게 됩니다.

## 2. 서버사이드 렌더링의 단점

### 2.1 프로젝트 복잡도

서버사이드 렌더링을 구현하게 된다면, 프로젝트의 구조가 많이 복잡해집니다. 단순히 렌더링만 하는 것은 문제가 되지 않지만, 리액트 라우터, 리덕스 등의 라이브러리와 함께 연동해서 사용하면, 서버ㅓ에서 데이터를 가져와 렌더링을 해줘야하는 경우에 조금 어려워질 수 있습니다.

### 2.2 성능 악화 가능성

클라이언트 초기 렌더링을 서버측에서 대신 해주니까, 클라이언트 부담을 없애주기는 하지만, 그 부담은 서버가 가져가게 됩니다. 서버사이드 렌더링을 하게 될 때는 `ReactDOMSerever.renderToString` 함수를 사용하게 됩니다. 이 함수는 동기적으로 작동합니다. 그래서, 랜더링 하는 동안은 이벤트 루프가 막히게 됩니다. 그 뜻은, 렌더링이 되는 동안은 다른 작업을 못 한다는 뜻입니다.

#### 2.2.1 비동기식 렌더링

써드파티 라이브러리를 통하여 비동기식으로 작동하게끔 코드을 작성 할 수 있습니다.

- **rapscalion:** renderToString을 비동기로 해주며, Promise 기반으로 작동하고, 컴포넌트 단위로 캐싱을 할 수 있습니다.
- **hypernova:** airbnb에서 만든 도구로서, 렌더링을 위한 서버를 따로 열어서 `cluster`를 사용하여 여러 프로세스를 생성하고 렌더링하여, 운영 서버에서 렌더링 서버로 결과물을 요청하는 방식으로 작동합니다.
- **react-router-server:** react-router v4를 위해 만들어진 서버사이드 렌더링 라이브러리로서, Promise 비동기식 렌더링을 지원해주고 깔끔한 방식으로 데이터를 불러올 수 도 있습니다.

#### 2.2.2 메타 태그만 넣어주기

리액트 어플리케이션을 렌더링하지 않고, 서버쪽에서 라우트에 따라 필요한 메타태그만 넣어주는 것 입니다. 그러면 크롤러에선 해당 페이지에 대한 기본 정보는 얻어 갈 수 있게 됩니다. SNS 공유를 할 때 내용이 잘 전달되게 하기; 위한 것이라면 매우 적합한 방식입니다.

#### 2.2.3 Prerender

만약에 검색엔진 최적화 때문에 서버사이드 렌더링을 구현해야 하는데, 프로젝트의 구조가 복잡해지는게 싫고, 또 성능이 받쳐주지 않는다면 `Prerender`를 사용합니다. `Prerender`는 리액트 코드를 문자열 형태로 변환하는게 아니라, 자바스크립트 렌더링 엔진을 가지고있어서 자바스크립트 코드를 실행시켜 뷰를 렌더링한 경로가 값을 반환하빈다. 렌더링 속도는 그렇게 빠르지 않기 때문에, 이 서비스는 오직 검색엔진 최적화를 위해서만 사용됩니다. 이 서비스는 유료 서비스이지만, 250개의 페이지까지는 무료입니다.

## 3. 출처

[react-router :: 3장. 서버사이드 렌더링](https://velopert.com/3425)
